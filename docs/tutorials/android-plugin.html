<!DOCTYPE html>
<!--[if (IE 7)&!(IEMobile)]><html class="no-js ie ie7" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js ie ie8" lang="en"><![endif]-->
<!--[if (IE 9)&!(IEMobile)]><html class="no-js ie ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<html>
<head>
<meta charset="utf-8">
<title>Kotlin Android Extensions</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<link rel="Shortcut Icon" href="/kotlin-web-site-cn/assets/images/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="/kotlin-web-site-cn/assets/images/apple-touch-icon.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/kotlin-web-site-cn/assets/images/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/kotlin-web-site-cn/assets/images/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/kotlin-web-site-cn/assets/images/apple-touch-icon-144x144.png" />
<link rel="stylesheet" href="/kotlin-web-site-cn/css/styles.css">
<script src="/kotlin-web-site-cn/js/vendor/requirejs/require.js"></script>
<script src="/kotlin-web-site-cn/js/config/bootstrap.js"></script>
</head>
<body>
<!-- <!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5P98');</script>
<!-- End Google Tag Manager -->
<!-- CrazyEgg -->
<script type="text/javascript">
setTimeout(function(){var a=document.createElement("script");
var b=document.getElementsByTagName("script")[0];
a.src=document.location.protocol+"//dnn506yrbagrg.cloudfront.net/pages/scripts/0013/6939.js?"+Math.floor(new Date().getTime()/3600000);
a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
</script>
<!-- End CrazyEgg -->
 -->

<div class="global-layout">

    <header class="global-header">

    <div class="global-header-panel">
        <div class="g-layout">
            <a class="global-header-logo" href="/kotlin-web-site-cn/">Kotlin</a>

            
                
            

            <nav role="navigation" class="global-nav">
    

    
        
        
        
        

        

        
            
        

        

        <a href="/kotlin-web-site-cn/docs/reference/"
           class="nav-item is_active"
        >
            学习
        </a>
    
        
        
        
        

        

        

        

        <a href="/kotlin-web-site-cn/contribute.html"
           class="nav-item "
        >
            贡献
        </a>
    
        
        
        
        

        

        

        
            
        

        <a href="http://try.kotlinlang.org"
           class="nav-item "
        >
            在线尝试
        </a>
    
        
        
        
        

        
            

    
        <div class="extra-nav download-button">
            <a href="/kotlin-web-site-cn/#get-kotlin" class="get-kotlin-button">
                Get Kotlin
                <span class="version">(0.14.449)</span>
            </a>
        </div>
    
</nav>

        </div>
    </div>
    
    <div class="g-layout">
        
    </div>
</header>

    <div class="g-layout global-content">
        <div class="g-grid">

    <div class="g-12">
        
    

    <nav role="navigation" class="docs-nav">
        
            
            

            <div class="nav-item-wrap">
            
                <a href="/kotlin-web-site-cn/docs/reference/" class="nav-item">
                    <span class="nav-item-text">
                        参考
                    </span>
                </a>

            
            </div>
        
            
            

            <div class="nav-item-wrap">
            
                    <a href="/kotlin-web-site-cn/docs/tutorials/" class="nav-item is_active">
                        <span class="nav-item-text">
                            教程
                        </span>
                    </a>
            
            </div>
        
            
            

            <div class="nav-item-wrap">
            
                <a href="/kotlin-web-site-cn/docs/videos.html" class="nav-item">
                    <span class="nav-item-text">
                        视频
                    </span>
                </a>

            
            </div>
        
            
            

            <div class="nav-item-wrap">
            
                <a href="/kotlin-web-site-cn/docs/events.html" class="nav-item">
                    <span class="nav-item-text">
                        事件记
                    </span>
                </a>

            
            </div>
        
            
            

            <div class="nav-item-wrap">
            
                <a href="/kotlin-web-site-cn/docs/resources.html" class="nav-item">
                    <span class="nav-item-text">
                        更多资源
                    </span>
                </a>

            
            </div>
        
    </nav>


    </div>

    <aside class="g-3">
        <div id="tutorials-nav">
            



    

        
            
        

        
    

        
            
        

        
    

        
            
        

        
    

        
            
        

        
    

        
            
        

        
    

    

        
            
        

        
    

        
            
        

        
    

    

        
            
        

        
    

    

        
            
        

        
    

        
            
        

        
    

    

        
            
        

        
    

        
            
        

        
            
        
    

    

        
            
        

        
    



<nav role="navigation" class="side-tree-nav">

    

    <div class="tree-item tree-branch js-item js-branch _closed"
         data-id="开始">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
            <div class="marker"></div>
            <div class="text">开始</div>
        </div>

        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/getting-started.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">从IntelliJ IDEA开始</span></a>
            
            </div>
        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/getting-started-eclipse.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">从Eclipse开始</span></a>
            
            </div>
        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/command-line.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">使用命令行</span></a>
            
            </div>
        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/build-tools.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">使用构建工具</span></a>
            
            </div>
        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/koans.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">Koans</span></a>
            
            </div>
        

    </div>

    

    

    <div class="tree-item tree-branch js-item js-branch _closed"
         data-id="JavaScript">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
            <div class="marker"></div>
            <div class="text">JavaScript</div>
        </div>

        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/create-library-js.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">使用IntelliJ IDEA创建Kotlin/JavaScript库</span></a>
            
            </div>
        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/command-line-library-js.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">使用命令行编译器创建Kotlin/JavaScript库</span></a>
            
            </div>
        

    </div>

    

    

    <div class="tree-item tree-branch js-item js-branch _closed"
         data-id="混合开发">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
            <div class="marker"></div>
            <div class="text">混合开发</div>
        </div>

        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/mixing-java-kotlin-intellij.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">项目中混合使用Java与Kotlin</span></a>
            
            </div>
        

    </div>

    

    

    <div class="tree-item tree-branch js-item js-branch _closed"
         data-id="Web开发">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
            <div class="marker"></div>
            <div class="text">Web开发</div>
        </div>

        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/httpservlets.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">创建Http Servlets web程序</span></a>
            
            </div>
        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/spring-boot-restful.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">Spring Boot创建RESTful Web服务</span></a>
            
            </div>
        

    </div>

    

    

    <div class="tree-item tree-branch js-item js-branch _opened"
         data-id="移动开发">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
            <div class="marker"></div>
            <div class="text">移动开发</div>
        </div>

        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/kotlin-android.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">Android开发入门</span></a>
            
            </div>
        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <div class="tree-item-title tree-leaf-title js-item-title js-leaf-title is_active">
                    <div class="marker"></div>
                    <div class="text">Kotlin Android 扩展</div>
                </div>
            
            </div>
        

    </div>

    

    

    <div class="tree-item tree-branch js-item js-branch _closed"
         data-id="Tools">

        <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
            <div class="marker"></div>
            <div class="text">Tools</div>
        </div>

        
            
            
                
                
            

            
            

            <div class="tree-item tree-leaf js-item js-leaf">
            
                <a href="/kotlin-web-site-cn/docs/tutorials/kotlin-and-ci.html"
                   class="tree-item-title tree-leaf-title js-item-title js-leaf-title "
                   ><span class="marker"></span><span class="text">TeamCity配置Kotlin</span></a>
            
            </div>
        

    </div>

    

</nav>
        </div>
    </aside>

    <article role="main" class="page-content g-9">
        


<a href="https://github.com/cctanfujun/kotlin-web-site-cn/edit/master/docs/tutorials/android-plugin.md"
   class="page-link-to-github"
   target="_blank"
   title="Edit this page on GitHub">
        <i class="github-icon"></i>
        <span class="text">Edit Page</span>
</a>

        <h1>
            Kotlin Android Extensions
        </h1>
        <table>
            
            <tr>
                <td>
                    <strong>Author</strong>
                </td>
                <td>
                    Yan Zhulanow
                </td>
            </tr>
            
            
            <tr>
                <td>
                    <strong>Last Updated</strong>
                </td>
                <td>
                    18 March 2015
                </td>
            </tr>
            
            
        </table>
        
            This tutorial describes how to use Kotlin Android Extensions to improve support for Android development
        <br/>
        <br/>
        
        <p>In this tutorial we’ll walk through the steps required to use the Kotlin Android Extensions plugin, enhancing the development experience with Android.</p>

<h3 id="background">Background<a href="#background" class="anchor"></a></h3>

<p>Every Android developer knows well the <code>findViewById()</code> function. It is, without a doubt, a source of potential bugs and nasty code which is hard to read and support.
While there are several libraries available that provide solutions to this problem, being libraries dependent on runtime, they require annotating fields for each <code>View</code>.</p>

<p>The Kotlin Android Extensions plugin allows us to obtain the same experience we have with some of these libraries, without having to add any extra code or shipping any additional runtime.</p>

<p>In essence, this would allow for the following code:</p>

<pre><code class="code-block _highlighted lang_kotlin"><span class="c1">// Using R.layout.main</span>
<span class="k">import</span> <span class="nn">kotlinx.android.synthetic.main.*</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">MyActivity</span> <span class="p">:</span> <span class="n">Activity</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span> <span class="n">Bundle</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">.</span><span class="n">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
        <span class="n">setContentView</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">layout</span><span class="p">.</span><span class="n">main</span><span class="p">)</span>
        <span class="n">textView</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">)</span> <span class="c1">// Instead of findView(R.id.textView) as TextView</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>

<p><code>textView</code> is an extension property for <code>Activity</code>, and it has the same type as declared in <code>main.xml</code>.</p>

<h3 id="using-kotlin-android-extensions">Using Kotlin Android Extensions<a href="#using-kotlin-android-extensions" class="anchor"></a></h3>

<h4 id="configuring-the-dependency">Configuring the dependency</h4>

<p>In this tutorial we’re going to be using Gradle but the same can be accomplished using either IntelliJ IDEA project structure or Maven. For details on setting up Gradle to work with Kotlin, see <a href="/docs/reference/using-gradle.html">Using Gradle</a>.</p>

<p>The IDE <a href="https://plugins.jetbrains.com/plugin?pluginId=7717">plugin</a> is available for both IntelliJ IDEA (Ultimate and Community Editions) as well as Android Studio.</p>

<p>Also, we need to add a buildscript dependency called <code>kotlin-android-extensions</code> to the application build file (usually <code>app/build.gradle</code>):</p>

<pre><code class="code-block _highlighted lang_groovy"><span class="n">buildscript</span> <span class="o">{</span>
    <span class="n">dependencies</span> <span class="o">{</span>
        <span class="n">classpath</span> <span class="s1">&#39;org.jetbrains.kotlin:kotlin-android-extensions:&lt;version&gt;&#39;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>

<p>A plugin for Gradle is available on Maven Central.</p>

<h4 id="importing-synthetic-properties">Importing synthetic properties</h4>

<p>It is convenient to import all widget properties for a specific layout in one go:</p>

<pre><code class="code-block _highlighted lang_kotlin"><span class="k">import</span> <span class="nn">kotlinx.android.synthetic.&lt;layout&gt;.*</span></code></pre>

<p>Thus if the layout filename is <code>main.xml</code>, we’d import <code>kotlinx.android.synthetic.main.*</code>.</p>

<p>If we want to call the synthetic properties on <code>View</code> (useful in adapter classes), we should also import <code>kotlinx.android.synthetic.main.view.*</code>.</p>

<p>Once we do that, we can then invoke the corresponding extensions, which are properties named after the views in the XML file. 
For example, for this view:</p>

<pre><code class="code-block _highlighted lang_xml">    <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">&quot;@+id/hello&quot;</span>
            <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
            <span class="na">android:text=</span><span class="s">&quot;Hello World, MyActivity&quot;</span>
            <span class="nt">/&gt;</span></code></pre>

<p>There will be property named <code>hello</code>:</p>

<pre><code class="code-block _highlighted lang_kotlin"><span class="n">activity</span><span class="p">.</span><span class="n">hello</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Hi!&quot;</span><span class="p">)</span></code></pre>

<h3 id="under-the-hood">Under the hood<a href="#under-the-hood" class="anchor"></a></h3>

<p>Kotlin Android Extensions is a plugin for the Kotlin compiler, and it does two things:</p>

<ol>
  <li>Adds a hidden caching function and a field inside each Kotlin <code>Activity</code>. The method is pretty small so it doesn’t increase the size of APK much.</li>
  <li>Replaces each synthetic property call with a function call.</li>
</ol>

<p>How this works is that when invoking a synthetic property, where the receiver is a Kotlin Activity/Fragment class that is in module sources, the caching function is invoked.
For instance, given</p>

<pre><code class="code-block _highlighted lang_kotlin"><span class="k">class</span> <span class="nc">MyActivity</span><span class="p">:</span> <span class="n">Activity</span><span class="p">()</span>
<span class="k">fun</span> <span class="nf">MyActivity</span><span class="p">.</span><span class="n">a</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">this</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="err">“”</span><span class="p">)</span> 
<span class="p">}</span></code></pre>

<p>a hidden caching function is generated inside MyActivity, so we can use the caching mechanism.</p>

<p>However in the following case:</p>

<pre><code class="code-block _highlighted lang_kotlin"><span class="k">fun</span> <span class="nf">Activity</span><span class="p">.</span><span class="n">b</span><span class="p">()</span> <span class="p">{</span> 
    <span class="k">this</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="err">“”</span><span class="p">)</span>     
<span class="p">}</span></code></pre>

<p>We wouldn’t know if this function would be invoked on only Activities from our sources or on plain Java Activities also. As such, we don’t use caching there, even
if MyActivity instance from the previous example is the receiver.</p>

    </article>
</div>



<script>require(['page/tutorials']);</script>
    </div>

</div>

<footer role="contentinfo" class="global-footer">

    <div class="global-footer-terms">
        <div class="g-layout">

            <div class="terms-copyright">
                &copy; 2000&ndash;2015 JetBrains. All rights reserved
            </div>

            <div class="terms-sponsor">
                Sponsored and developed by <a href="http://jetbrains.com" class="sponsor sponsor_jetbrains" target="_blank">JetBrains</a> Translation by <a href="http://tanfujun.cc" class="testimonial-company-link" target="_blank" rel="nofollow">晓_晨DEV</a>
            </div>
        </div>
    </div>

</footer>
</body>
</html>